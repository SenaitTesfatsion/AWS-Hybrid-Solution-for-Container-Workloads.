
# Designing a hybrid solution for container based workloads on AWS
This project shows how to design a hybrid solution in the AWS cloud. The architecture is designed for a scenario where an organization running container workloads and PostgreSQL database on premises plans to migrate part of the workloads to AWS. The solution implements lift and shift migration strategy since one of the main requirment in the scenario is to move the applicatios  without rewriting the code. The architecture aims to meet the specific requirement of the organization.
# Requirments
- Run Containers on AWS.
- The organization containers will be running internal applications that donâ€™t require inbound communication from the internet. 
- The applications will require outbound communication to the internet.
- Use custom Amazon Machine Image (AMI) for the cluster that hosts the containers.
- Have SSH access to underlying instances.
- Host a PostgreSQL database on AWS.
- Use common orchestration tools across both on-prem and the cloud.
- Store data generated on premises in AWS with minimal refactoring.
- The containers running on AWS will need to access that data.
- A Network File System (NFS) protocol for all on-premises applications.
- Low latency and consistent connectivity between on-prem and AWS for high volume data.
- Optimize for resilience.

# Cloud Solution
- **VPC:** for hosting the resources in AWS. Amazon Virtual Private Cloud (Amazon VPC) enables you to launch AWS resources into a virtual network that you've defined. 
- **Private Subnet:** for internal applications that do not need to have ingress connectivity from the internet.
-**Application Load Balancer:** for distributing incoming traffic across the containers.
- **AWS Direct Connect:** for providing consistent dedicated throughput for high volume of data that flows between on-prem and AWS.
- **Elastic Container Service**:  Amazon Elastic Container Service (Amazon ECS) is a fully managed container orchestration service for deploying, managing, and scaling containerized applications.
- **EC2:**  compute platform for the containers. EC2 allows you to use your own image for the cluster servers.
- **NAT Gateway:** for egress communication from private instances.
- **Amazon RDS:** for migration the on premises database with Multi-AZ deployment, Amazon RDS automatically creates a primary database (DB) instance and synchronously replicates the data to an instance in a different Availability Zone. When it detects a failure, Amazon RDS automatically fails over to a standby instance without manual intervention. This failover mechanism meets the resilience requirment.
- **AWS Database Migration Service (Amazon DMS):** for migrating data from their on-premises database to Amazon RDS. AWS DMS helps you migrate databases to AWS quickly and securely. The source database remains fully operational during the migration, which minimizes the downtime to applications that rely on the database.
- **AWS Storage Gateway:** to provide near-seamless integration with data security features between your on-premises IT environment and the AWS storage infrastructure. This meets the requirment for storing data generated by the on-prem containers in AWS using NFS protocol.
- **Amazon S3:** for long term storage of the data in AWS. S3 is an object storage service.
- **Amazon ECS Anywhere:** a feature of Amazon ECS that you can use to run and manage container workloads on customer-managed infrastructure.
Amazon ECS Anywhere builds on the ease and simplicity of Amazon ECS to provide a consistent experience across your container-based applications for working with tooling and APIs. 

- **AWS Backup:** for managing backups in one centralized place. AWS Backup is a fully-managed service that makes it easy to centralize and automate data protection across AWS services, in the cloud, and on premises.
- **AWS SystemsManager:** for providing a unified user interface that you can use to view operational data from multiple AWS services and automate operational tasks across your AWS resources.
- **Elastic Container Registry:** for storing the container images. ECR is a fully managed container registry that makes it easy to store, share and deploy container images.
# Architecture Optimization
- **IPsec VPN:** Internet Protocol security (IPsec) virtual private network (VPN) connection as a backup for AWS direct connect. All virtual private cloud (VPC) traffic will fail over to the VPN connection automatically.
- **Disaster recovery plan:** Backup and restore is a suitable approach against data loss or corruption. Using a secondary AWS region, data can be replicated to mitigate the risk of regional disaster. In addition to data, the infrastructure, configuration and application code is deployed in the recovery region.
- **CloudFormation:** Infrastructure as code tool which enables you to redeploy infrastructures in multiple regions quickly without errors.
- **Amazon ECS cluster auto scaling:** for managing the scaling of EC2 instances that are registered to your cluster by attaching target  tracking policy to the Auto Scaling group.
- **Enable storage autoscaling for an RDS DB instance:** automatically scales up your storage when it detects that you are running out of free database space.
- **RDS read-replica:** one of the read-replica in RDS can be promoted to primary database in case of disaster therby ensuring relisliency.
-**Amazon S3 Intelligent-Tiering:** optimize storage costs by automatically moving data to the most cost-effective access tier when access patterns change.
- **Amazon S3 Cross-Region Replication:** automatically replicate data across AWS regions.
